insert into client select
increment_sequence('client_seq'), 'Roche Training', null,
HANDHELD_STALE_PERIOD,'HLR_PHARM_TRAIN',CONFIDENTIALITY_MESSAGE,
'HLR_PHARM_TRAIN','HLRR'  from client where id=158
/

commit;

insert into client_div select increment_sequence('client_div_seq'),
id,'Roche Pharmaceuticals - Training',24,1,null,'Industry Cost','HLR_PHARM_TRAIN', null,
24,<build tag>,0,'Med',0,null,0,0,null,null,null,0,<TSPD_BUILD_TAG>,'Entering',1,'PULL',1,
null,null,null,1,null,null,null,0,0,0 from client where CLIENT_ACRONYM='HLR_PHARM_TRAIN'
/

commit;

insert into ftuser select increment_sequence('ftuser_seq'),
'fasttrack@HLR_PHARM_TRAIN','Kobra427',null,'HOME',sysdate,'FTAdmin','USer',
null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,163,98,'Ftadmin User',
0,0,0,null,null,1,0,0,null,null,null,0,null,0,null,null from dual;

commit;

insert into ftuser select increment_sequence('ftuser_seq'),
'dgemzik@HLR_PHARM_TRAIN','abc_123',null,'HOME',null,'David','Gemzik',
null,null,null,null,null,null,null,null,
'(215)358-1472',null,null,null,'dgemzik@medidata.com',null,null,163,98,'David Gemzik',
0,0,0,null,null,1,0,0,null,sysdate,null,0,null,0,null,null from dual;

insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,17 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,18 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,19 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,20 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,21 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,22 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2321,23 from dual;
commit;

insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,17 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,18 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,19 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,20 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,21 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,22 from dual;
insert into ftuser_to_ftgroup select increment_sequence('ftuser_to_ftgroup_seq'),2322,23 from dual;
commit;

insert into password_rule select increment_sequence('password_rule_seq'),
98,USERNAME_MIN_CHARS,
USERNAME_MAX_CHARS,
PASSWORD_MIN_CHARS,
PASSWORD_MAX_CHARS,
PASSWORD_HAS_NUMERIC,
PASSWORD_VALID_DAYS,
PASSWORD_NTFY_USER_DAYS,
PASSWORD_ALLOW_REUSE_DAYS,
LOCKOUT_INACTIVITY_DAYS,
LOCKOUT_LOGIN_ATTEMPTS
from password_rule where CLIENT_DIV_ID=92
/

commit;

alter trigger CLIENT_DIV_TO_LIC_APP_TRG1 disable;

insert into client_div_to_lic_app select
increment_sequence('client_div_to_lic_app_seq'),98,
APP_NAME,'31-DEC-2007',2322,VERSION,FRONTEND_VERSION,
PATCH_AVAILABLE,PATCH_VERSION,ALERT_EMAIL,app_components from
client_div_to_lic_app where client_div_id=92 and app_name='TSPD' ;

commit;
alter trigger CLIENT_DIV_TO_LIC_APP_TRG1 enable;

 insert into tspd_template select 275, 14,
 LAST_UPDATED,NAME,DATA,SOFTWARE_VERSION,365,
 VERSION,STATUS,CREATE_DATE,365,RELEASED_DATE,
 RETIRED_DATE,LOCALE,DATE_FORMAT,STARTEAM_TAG
 from tspd_template where id=14;


 commit;

drop database link mylink;

create database link mylink connect to 
tsm10g identified by kra8gpwl using 'prod';


declare

 lil_prod_id number(10);
 lil_prod_userid number(10);
 
 cursor c1 is select id from tspd_lib_bucket where
 client_div_id in (select id from client_div where
 client_div_identifier='FTD');

 prod_lib_bucket_max_id  number(10);
 prod_lib_element_max_id number(10);

begin

 select id into lil_prod_id from  client_div where client_div_identifier='HLR_TRAIN';
  select id into lil_prod_userid from  ftuser where name='dgemzik@HLR_TRAIN';
 select nvl(max(id),0)+1 into prod_lib_bucket_max_id from tspd_lib_bucket;
 select nvl(max(id),0)+1 into prod_lib_element_max_id from tspd_lib_element;

for ix1 in c1 loop

  insert into tspd_lib_bucket select prod_lib_bucket_max_id,name,create_date,
  lil_prod_id,last_updated,version_timestamp from tspd_lib_bucket where
  id=ix1.id;
  declare
    cursor c3 is select id from tspd_lib_element where
    tspd_lib_bucket_id=ix1.id;
  begin
    for ix3 in c3 loop
      insert into tspd_lib_element select prod_lib_element_max_id, 
       prod_lib_bucket_max_id,name,create_date,content_type,lil_prod_userid,
       content_subtype, filename, data, tooltip, filepath, inline_data from
       tspd_lib_element where id=ix3.id;
       prod_lib_element_max_id:=prod_lib_element_max_id+1;
    end loop;
  end;   
 prod_lib_bucket_max_id:=prod_lib_bucket_max_id+1;
end loop;


update id_control set next_id=prod_lib_bucket_max_id where
table_name='tspd_lib_bucket';
update id_control set next_id=prod_lib_element_max_id where
table_name='tspd_lib_element';

end;
/

declare
 clientdiv_id number(10);
 ftuserid number(10);
 ftuser_name varchar2(128):='dgemzik@HLR_TRAIN';
 criteria_set_maxid number(10);
 criteria_set_item_maxid number(10);
 criteria_maxid number(10);
 cursor c1 is select id from criteria_set where client_div_id=12;
begin
 select id into clientdiv_id from client_div where client_div_identifier='HLR_TRAIN';
 select id into ftuserid from  ftuser where name=ftuser_name;
 select nvl(max(id),0)+1 into criteria_set_maxid from criteria_set;
 select nvl(max(id),0)+1 into criteria_set_item_maxid from criteria_set_item;
 select nvl(max(id),0)+1 into criteria_maxid from criteria;

 for ix1 in c1 loop
   Insert into criteria_set select criteria_set_maxid, name, create_date,
   clientdiv_id, ftuserid, version_timestamp from criteria_set where id=ix1.id;

   declare
    cursor c2 is select id, criteria_id from criteria_set_item where
    criteria_set_id=ix1.id;   
   begin
    for ix2 in c2 loop 
      insert into criteria select criteria_maxid,clientdiv_id,type,short_desc,
         long_desc, rationale, other_desc,CLASSIFIER,OTHER_CLASSIFIER_DESC
         from criteria where id=ix2.criteria_id;
      insert into criteria_set_item values(criteria_set_item_maxid,
         criteria_set_maxid,criteria_maxid);
      criteria_set_item_maxid:=criteria_set_item_maxid+1;
      criteria_maxid:=criteria_maxid+1;
    end loop;
   end;
 criteria_set_maxid:=criteria_set_maxid+1; 
 end loop;

 update id_control set next_id=criteria_set_maxid where 
 table_name='criteria_set';
 update id_control set next_id=criteria_set_item_maxid where 
 table_name='criteria_set_item';
 update id_control set next_id=criteria_maxid where 
 table_name='criteria';

end;
/


declare

target_client_div varchar2(10):='HLR_TRAIN';
source_client_div varchar2(10):='FTD';
target_user varchar2(128):='dgemzik@HLR_TRAIN';

cursor c1 is select id from custom_set where client_div_id in
(select id from client_div where client_div_identifier=source_client_div);

target_custom_set_maxid number(10);
target_custom_set_item_maxid number(10);

target_client_div_id number(10);
target_userid number(10);

begin

select nvl(max(id),0)+1 into target_custom_set_maxid  from custom_set;
select nvl(max(id),0)+1 into target_custom_set_item_maxid  from custom_set_item;

select id into target_client_div_id from client_div 
	where client_div_identifier=target_client_div;
select id into target_userid from ftuser where name=target_user;


for ix1 in c1 loop

   Insert into custom_set select target_custom_set_maxid,name,create_dt,
      target_client_div_id, type, target_userid, version_timestamp from custom_set
      where id=ix1.id;

      declare
	cursor c2 is select id from custom_set_item where custom_set_id=ix1.id and
        unlisted_procedure_id is not null;
	cursor c3 is select id from custom_set_item where custom_set_id=ix1.id and
        procedure_def_id is not null; 
	cursor c4 is select id from custom_set_item where custom_set_id=ix1.id and
        odc_def_id is not null; 
        
        target_procedure_def_id number(10);
        target_odc_def_id number(10);
        target_unlisted_procedure_id number(10);

      begin

         for ix2 in c2 loop
            select id into target_unlisted_procedure_id from unlisted_procedure
            where name = (select name from unlisted_procedure where id = (select
            UNLISTED_PROCEDURE_ID from custom_set_item where id=ix2.id));

            Insert into custom_set_item select target_custom_set_item_maxid,
	    target_custom_set_maxid,target_unlisted_procedure_id,null,null,price,short_desc,long_desc 
	    from custom_set_item where id = ix2.id;
            
	    target_custom_set_item_maxid:=target_custom_set_item_maxid+1;


         end loop;

         for ix3 in c3 loop

            select id into target_procedure_def_id from procedure_def
            where cpt_code = (select cpt_code from procedure_def where id = (select
            PROCEDURE_DEF_ID from custom_set_item where id=ix3.id));

            Insert into custom_set_item select target_custom_set_item_maxid,
	    target_custom_set_maxid,null,null,target_procedure_def_id,price,short_desc,long_desc 
	    from custom_set_item where id =ix3.id;

	    target_custom_set_item_maxid:=target_custom_set_item_maxid+1;

         end loop;

         for ix4 in c4 loop

            select id into target_odc_def_id from odc_def
            where picas_code = (select picas_code from odc_def where id = (select
            ODC_DEF_ID from custom_set_item where id=ix4.id));

            Insert into custom_set_item select target_custom_set_item_maxid,
	    target_custom_set_maxid,null,target_odc_def_id,null,price,short_desc,long_desc 
	    from custom_set_item where id =ix4.id;

	    target_custom_set_item_maxid:=target_custom_set_item_maxid+1;

         end loop;
      end;

 target_custom_set_maxid:=target_custom_set_maxid+1;

 end loop;

 update id_control set next_id=target_custom_set_maxid where 
 table_name='custom_set';
 update id_control set next_id=target_custom_set_item_maxid where 
 table_name='custom_set_item';

end;
/

