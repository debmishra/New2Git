-- ************Query for CPP starts here***************

select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.75
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.25
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.1 and ocpp_grants_med*1.9
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.1 and ocpp_grants_med*1.9
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.2 and ocpp_grants_med*1.8
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.2 and ocpp_grants_med*1.8
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.3 and ocpp_grants_med*1.7
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.3 and ocpp_grants_med*1.7
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.4 and ocpp_grants_med*1.6
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.4 and ocpp_grants_med*1.6
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.5 and ocpp_grants_med*1.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.5 and ocpp_grants_med*1.5
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.6 and ocpp_grants_med*1.4
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.6 and ocpp_grants_med*1.4
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.7 and ocpp_grants_med*1.3
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.7 and ocpp_grants_med*1.3
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.8 and ocpp_grants_med*1.2
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.8 and ocpp_grants_med*1.2
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.9 and ocpp_grants_med*1.1
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.9 and ocpp_grants_med*1.1
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med <> 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.95 and ocpp_grants_med*1.05
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.95 and ocpp_grants_med*1.05
and ocpp_grants_med <> 0 and ocpp_med <> 0 ) c;

-- ********2nd cpp query starts here*********

select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*5
and ocpp_grants_med <> 0 and ocpp_med = 0  ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*5
and ocpp_grants_med <> 0 and ocpp_med = 0  ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*4
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*4
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*3
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*3
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.75
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2.25
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*0 and ocpp_grants_med*2
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*0 and ocpp_grants_med*2
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.1 and ocpp_grants_med*1.9
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.1 and ocpp_grants_med*1.9
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.2 and ocpp_grants_med*1.8
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.2 and ocpp_grants_med*1.8
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.3 and ocpp_grants_med*1.7
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.3 and ocpp_grants_med*1.7
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.4 and ocpp_grants_med*1.6
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.4 and ocpp_grants_med*1.6
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.5 and ocpp_grants_med*1.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.5 and ocpp_grants_med*1.5
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.6 and ocpp_grants_med*1.4
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.6 and ocpp_grants_med*1.4
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.7 and ocpp_grants_med*1.3
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.7 and ocpp_grants_med*1.3
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.8 and ocpp_grants_med*1.2
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.8 and ocpp_grants_med*1.2
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.9 and ocpp_grants_med*1.1
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.9 and ocpp_grants_med*1.1
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c
union all
select a.tot_cpp Total, round((b.old_cnt/a.tot_cpp)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpp)*100,2) New_percent from
(select count(*) tot_cpp from ipm_phase2to4 where ocpp_grants_med <> 0 and ocpp_med = 0 ) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpp_med between ocpp_grants_med*.95 and ocpp_grants_med*1.05
and ocpp_grants_med <> 0 and ocpp_med = 0 ) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpp_new_med between ocpp_grants_med*.95 and ocpp_grants_med*1.05
and ocpp_grants_med <> 0 and ocpp_med = 0 ) c;

-- ****************************************************
-- ************Query for CPV starts here***************
-- ****************************************************

select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*5
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*5
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.75
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.25
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.1 and ocpv_grants_med*1.9
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.1 and ocpv_grants_med*1.9
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.2 and ocpv_grants_med*1.8
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.2 and ocpv_grants_med*1.8
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.3 and ocpv_grants_med*1.7
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.3 and ocpv_grants_med*1.7
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.4 and ocpv_grants_med*1.6
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.4 and ocpv_grants_med*1.6
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.5 and ocpv_grants_med*1.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.5 and ocpv_grants_med*1.5
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.6 and ocpv_grants_med*1.4
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.6 and ocpv_grants_med*1.4
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.7 and ocpv_grants_med*1.3
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.7 and ocpv_grants_med*1.3
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.8 and ocpv_grants_med*1.2
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.8 and ocpv_grants_med*1.2
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.9 and ocpv_grants_med*1.1
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.9 and ocpv_grants_med*1.1
and ocpv_grants_med <> 0 and ocpv_med <> 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.95 and ocpv_grants_med*1.05
and ocpv_grants_med <> 0 and ocpv_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.95 and ocpv_grants_med*1.05
and ocpv_grants_med <> 0 and ocpv_med <> 0) c;

--************2nd cpv query starts here***************

select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*5
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*5
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.75
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.75
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.5
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.5
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4.25
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4.25
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*4
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*4
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.75
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.75
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.5
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.5
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3.25
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3.25
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*3
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*3
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.75
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.75
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.5
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.5
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2.25
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2.25
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*0 and ocpv_grants_med*2
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*0 and ocpv_grants_med*2
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.1 and ocpv_grants_med*1.9
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.1 and ocpv_grants_med*1.9
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.2 and ocpv_grants_med*1.8
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.2 and ocpv_grants_med*1.8
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.3 and ocpv_grants_med*1.7
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.3 and ocpv_grants_med*1.7
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.4 and ocpv_grants_med*1.6
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.4 and ocpv_grants_med*1.6
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.5 and ocpv_grants_med*1.5
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.5 and ocpv_grants_med*1.5
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.6 and ocpv_grants_med*1.4
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.6 and ocpv_grants_med*1.4
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.7 and ocpv_grants_med*1.3
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.7 and ocpv_grants_med*1.3
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.8 and ocpv_grants_med*1.2
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.8 and ocpv_grants_med*1.2
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.9 and ocpv_grants_med*1.1
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.9 and ocpv_grants_med*1.1
and ocpv_grants_med <> 0 and ocpv_med = 0) c
union all
select a.tot_cpv Total, round((b.old_cnt/a.tot_cpv)*100,2) Old_percent,
round((c.new_cnt/a.tot_cpv)*100,2) New_percent from
(select count(*) tot_cpv from ipm_phase2to4 where ocpv_grants_med <> 0 and ocpv_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ocpv_med between ocpv_grants_med*.95 and ocpv_grants_med*1.05
and ocpv_grants_med <> 0 and ocpv_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ocpv_new_med between ocpv_grants_med*.95 and ocpv_grants_med*1.05
and ocpv_grants_med <> 0 and ocpv_med = 0) c;

-- ****************************************************
-- ************Query for simple starts here************
-- ****************************************************

select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and ismp_med <> 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and ismp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and ismp_med <> 0) c;

-- ******2nd query for simple cost starts here *************

select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and ismp_med = 0) c
union all
select a.tot_ismp Total, round((b.old_cnt/a.tot_ismp)*100,2) Old_percent,
round((c.new_cnt/a.tot_ismp)*100,2) New_percent from
(select count(*) tot_ismp from ipm_phase2to4 where ismp_grants_med <> 0 and ismp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
ismp_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and ismp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
ismp_new_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and ismp_med = 0) c;

-- ****************************************************
-- ************Query for complex starts here***********
-- ****************************************************

select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and icmp_med <> 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med <> 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and icmp_med <> 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and icmp_med <> 0) c;

-- *******2nd complex query starts here********

select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*5
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.75
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.5
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4.25
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*4
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.75
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.5
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3.25
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*3
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.75
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.5
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2.25
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*0 and ismp_grants_med*2
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.1 and ismp_grants_med*1.9
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.2 and ismp_grants_med*1.8
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.3 and ismp_grants_med*1.7
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.4 and ismp_grants_med*1.6
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.5 and ismp_grants_med*1.5
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.6 and ismp_grants_med*1.4
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.7 and ismp_grants_med*1.3
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.8 and ismp_grants_med*1.2
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.9 and ismp_grants_med*1.1
and ismp_grants_med <> 0 and icmp_med = 0) c
union all
select a.tot_icmp Total, round((b.old_cnt/a.tot_icmp)*100,2) Old_percent,
round((c.new_cnt/a.tot_icmp)*100,2) New_percent from
(select count(*) tot_icmp from ipm_phase2to4 where ismp_grants_med <> 0 and icmp_med = 0) a,
(select count(*) old_cnt from ipm_phase2to4 where 
icmp_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and icmp_med = 0) b,
(select count(*) new_cnt from ipm_phase2to4 where 
icmp_new_med between ismp_grants_med*.95 and ismp_grants_med*1.05
and ismp_grants_med <> 0 and icmp_med = 0) c;

